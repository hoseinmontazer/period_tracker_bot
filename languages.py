# English messages
EN = {
    'welcome': {
        'initial': "Welcome! Please select your language:\n\n!Ø¨Ù‡ Ø±Ø¨Ø§Øª Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯! Ù„Ø·ÙØ§ Ø²Ø¨Ø§Ù† Ø®ÙˆØ¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯",
        'bot': "Welcome to Period Tracker Bot! Please choose an option:"
    },
    'menu': {
        'main': "ðŸ“‹ **Main Menu**\nChoose an option:",
        'track_period': "Track Period",
        'view_history': "View History",
        'cycle_analysis': "Cycle Analysis",
        'add_new_cycle': "Add New Cycle",
        'logout': "Logout",
        'language_changed': "Language changed to English",
        'invitation_partner': 'Generate Partner Invitation',
        'accept_invitation': 'Accept Invitation Code'
    },
    'auth': {
        'login_required': "âš ï¸ You need to log in first. Use /start.",
        'enter_username': "Please enter your username:",
        'enter_password': "Enter your password:",
        'enter_email': "Enter your email address (e.g., example@gmail.com):",
        'invalid_email': "Please enter a valid email address (e.g., example@gmail.com):",
        'reg_success': "Registration successful!",
        'login_failed': "âŒ Login failed. Please try again.",
        'logged_out': "You have been logged out. Use /start to log in again.",
        'not_logged_in': "You are not logged in.",
        'register': "Register",
        'login': "Login"
    },
    'cycle': {
        'select_date': "Please select the start date:",
        'selected_date': "Selected date: {}",
        'select_symptoms': "Select your symptoms (you can select multiple):",
        'select_medications': "Select your medications (you can select multiple):",
        'custom_symptoms': "Please type your symptoms and press 'Done' when finished:",
        'custom_medication': "Please type your medication and press 'Done' when finished:",
        'added_item': "Added: {}\nSelected {}: {}\n\nSelect more or press 'Done'",
        'save_success': "âœ… Cycle data has been saved successfully!",
        'save_failed': "âŒ Failed to save cycle data: {}"
    },
    'buttons': {
        'done': "Done",
        'cancel': "Cancel",
        'write_custom_symptoms': "Write Custom Symptoms",
        'write_custom_medication': "Write Custom Medication"
    },
    'errors': {
        'token_expired': "Token has expired. Please try again.",
        'no_history': "â„¹ï¸ You have no recorded period history.",
        'fetch_failed': "âŒ Failed to retrieve history. Please try again later.",
        'unknown_duration': "?",
        'operation_cancelled': "Operation cancelled."
    },
    'period_history': {
        'title': "ðŸ“… **Your Period History**:",
        'cycle': "âœ¨ *Cycle {}* âœ¨",
        'predicted': "ðŸ”® Predicted",
        'duration': "â³ Duration",
        'symptoms_title': "ðŸ’« *Symptoms*",
        'medicine_title': "ðŸ’Š *Medicine*",
        'none_noted': "None noted",
        'none_taken': "None taken",
        'days': "d"  # for days abbreviation
    },
    'settings': {
        'menu': "âš™ï¸ **Settings**\nChoose an option:",
        'change_language': "ðŸŒ Change Language",
        'back_to_main': "â†©ï¸ Back to Main Menu"
    },
    'invitation': {
        'code_generated': "ðŸŽŸï¸ Your invitation code is: `{}`\nShare this code with your partner.",
        'enter_code': "Please enter the invitation code you received:",
        'accepted': "âœ… Invitation accepted successfully!",
        'generation_error': "âŒ Error generating invitation code. Please try again.",
        'acceptance_error': "âŒ Error accepting invitation. Please check the code and try again.",
        'invalid_code': "âŒ Invalid invitation code. Please try again."
    }
}

# Persian messages
FA = {
    'welcome': {
        'initial': "Welcome! Please select your language:\n\n!Ø¨Ù‡ Ø±Ø¨Ø§Øª Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯! Ù„Ø·ÙØ§ Ø²Ø¨Ø§Ù† Ø®ÙˆØ¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯",
        'bot': "Ø¨Ù‡ Ø±Ø¨Ø§Øª Ø±Ø¯ÛŒØ§Ø¨ Ø¯ÙˆØ±Ù‡ Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯! Ù„Ø·ÙØ§Ù‹ ÛŒÚ© Ú¯Ø²ÛŒÙ†Ù‡ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯:"
    },
    'menu': {
        'main': "ðŸ“‹ **Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ**\nÛŒÚ© Ú¯Ø²ÛŒÙ†Ù‡ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯:",
        'track_period': "Ø«Ø¨Øª Ø¯ÙˆØ±Ù‡",
        'view_history': "Ù…Ø´Ø§Ù‡Ø¯Ù‡ ØªØ§Ø±ÛŒØ®Ú†Ù‡",
        'cycle_analysis': "ØªØ­Ù„ÛŒÙ„ Ø¯ÙˆØ±Ù‡",
        'add_new_cycle': "Ø§ÙØ²ÙˆØ¯Ù† Ø¯ÙˆØ±Ù‡ Ø¬Ø¯ÛŒØ¯",
        'logout': "Ø®Ø±ÙˆØ¬",
        'language_changed': "Ø²Ø¨Ø§Ù† Ø¨Ù‡ ÙØ§Ø±Ø³ÛŒ ØªØºÛŒÛŒØ± Ú©Ø±Ø¯",
        'invitation_partner': 'Ø¯Ø¹ÙˆØª Ø§Ø² Ø´Ø±ÛŒÚ©',
        'accept_invitation': 'Ù¾Ø°ÛŒØ±Ø´ Ú©Ø¯ Ø¯Ø¹ÙˆØª'
    },
    'auth': {
        'login_required': "âš ï¸ Ø§Ø¨ØªØ¯Ø§ Ø¨Ø§ÛŒØ¯ ÙˆØ§Ø±Ø¯ Ø´ÙˆÛŒØ¯. Ø§Ø² /start Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.",
        'enter_username': "Ù„Ø·ÙØ§Ù‹ Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:",
        'enter_password': "Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:",
        'enter_email': "Ø¢Ø¯Ø±Ø³ Ø§ÛŒÙ…ÛŒÙ„ Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ (Ù…Ø«Ø§Ù„: example@gmail.com):",
        'invalid_email': "Ù„Ø·ÙØ§Ù‹ ÛŒÚ© Ø¢Ø¯Ø±Ø³ Ø§ÛŒÙ…ÛŒÙ„ Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ (Ù…Ø«Ø§Ù„: example@gmail.com):",
        'reg_success': "Ø«Ø¨Øª Ù†Ø§Ù… Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯!",
        'login_failed': "âŒ ÙˆØ±ÙˆØ¯ Ù†Ø§Ù…ÙˆÙÙ‚ Ø¨ÙˆØ¯. Ù„Ø·ÙØ§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.",
        'logged_out': "Ø´Ù…Ø§ Ø§Ø² Ø³ÛŒØ³ØªÙ… Ø®Ø§Ø±Ø¬ Ø´Ø¯ÛŒØ¯. Ø¨Ø±Ø§ÛŒ ÙˆØ±ÙˆØ¯ Ù…Ø¬Ø¯Ø¯ Ø§Ø² /start Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.",
        'not_logged_in': "Ø´Ù…Ø§ ÙˆØ§Ø±Ø¯ Ù†Ø´Ø¯Ù‡â€ŒØ§ÛŒØ¯.",
        'register': "Ø«Ø¨Øª Ù†Ø§Ù…",
        'login': "ÙˆØ±ÙˆØ¯"
    },
    'cycle': {
        'select_date': "Ù„Ø·ÙØ§Ù‹ ØªØ§Ø±ÛŒØ® Ø´Ø±ÙˆØ¹ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯:",
        'selected_date': "ØªØ§Ø±ÛŒØ® Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡: {}",
        'select_symptoms': "Ø¹Ù„Ø§Ø¦Ù… Ø®ÙˆØ¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯ (Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ú†Ù†Ø¯ Ù…ÙˆØ±Ø¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯):",
        'select_medications': "Ø¯Ø§Ø±ÙˆÙ‡Ø§ÛŒ Ø®ÙˆØ¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯ (Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ú†Ù†Ø¯ Ù…ÙˆØ±Ø¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯):",
        'custom_symptoms': "Ù„Ø·ÙØ§Ù‹ Ø¹Ù„Ø§Ø¦Ù… Ø®ÙˆØ¯ Ø±Ø§ ØªØ§ÛŒÙ¾ Ú©Ù†ÛŒØ¯ Ùˆ Ù¾Ø³ Ø§Ø² Ø§ØªÙ…Ø§Ù… 'Ù¾Ø§ÛŒØ§Ù†' Ø±Ø§ ÙØ´Ø§Ø± Ø¯Ù‡ÛŒØ¯:",
        'custom_medication': "Ù„Ø·ÙØ§Ù‹ Ø¯Ø§Ø±ÙˆÛŒ Ø®ÙˆØ¯ Ø±Ø§ ØªØ§ÛŒÙ¾ Ú©Ù†ÛŒØ¯ Ùˆ Ù¾Ø³ Ø§Ø² Ø§ØªÙ…Ø§Ù… 'Ù¾Ø§ÛŒØ§Ù†' Ø±Ø§ ÙØ´Ø§Ø± Ø¯Ù‡ÛŒØ¯:",
        'added_item': "Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯: {}\nÙ…ÙˆØ§Ø±Ø¯ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡ {}: {}\n\nÙ…ÙˆØ§Ø±Ø¯ Ø¨ÛŒØ´ØªØ±ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯ ÛŒØ§ 'Ù¾Ø§ÛŒØ§Ù†' Ø±Ø§ ÙØ´Ø§Ø± Ø¯Ù‡ÛŒØ¯",
        'save_success': "âœ… Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯ÙˆØ±Ù‡ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯!",
        'save_failed': "âŒ Ø°Ø®ÛŒØ±Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯ÙˆØ±Ù‡ Ù†Ø§Ù…ÙˆÙÙ‚ Ø¨ÙˆØ¯: {}"
    },
    'buttons': {
        'done': "Ù¾Ø§ÛŒØ§Ù†",
        'cancel': "Ù„ØºÙˆ",
        'write_custom_symptoms': "Ù†ÙˆØ´ØªÙ† Ø¹Ù„Ø§Ø¦Ù… Ø³ÙØ§Ø±Ø´ÛŒ",
        'write_custom_medication': "Ù†ÙˆØ´ØªÙ† Ø¯Ø§Ø±ÙˆÛŒ Ø³ÙØ§Ø±Ø´ÛŒ"
    },
    'errors': {
        'token_expired': "ØªÙˆÚ©Ù† Ù…Ù†Ù‚Ø¶ÛŒ Ø´Ø¯Ù‡ Ø§Ø³Øª. Ù„Ø·ÙØ§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.",
        'no_history': "â„¹ï¸ Ø´Ù…Ø§ Ù‡ÛŒÚ† Ø³Ø§Ø¨Ù‚Ù‡ Ø¯ÙˆØ±Ù‡â€ŒØ§ÛŒ Ø«Ø¨Øª Ø´Ø¯Ù‡â€ŒØ§ÛŒ Ù†Ø¯Ø§Ø±ÛŒØ¯.",
        'fetch_failed': "âŒ Ø¯Ø±ÛŒØ§ÙØª ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ù†Ø§Ù…ÙˆÙÙ‚ Ø¨ÙˆØ¯. Ù„Ø·ÙØ§Ù‹ Ø¨Ø¹Ø¯Ø§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.",
        'unknown_duration': "ØŸ",
        'operation_cancelled': "Ø¹Ù…Ù„ÛŒØ§Øª Ù„ØºÙˆ Ø´Ø¯."
    },
    'period_history': {
        'title': "ðŸ“… **ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ø¯ÙˆØ±Ù‡ Ø´Ù…Ø§**:",
        'cycle': "âœ¨ *Ø¯ÙˆØ±Ù‡ {}* âœ¨",
        'predicted': "ðŸ”® Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ø´Ø¯Ù‡",
        'duration': "â³ Ù…Ø¯Øª",
        'symptoms_title': "ðŸ’« *Ø¹Ù„Ø§Ø¦Ù…*",
        'medicine_title': "ðŸ’Š *Ø¯Ø§Ø±Ùˆ*",
        'none_noted': "Ù‡ÛŒÚ† Ø¹Ù„Ø§Ù…ØªÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡",
        'none_taken': "Ù‡ÛŒÚ† Ø¯Ø§Ø±ÙˆÛŒÛŒ Ù…ØµØ±Ù Ù†Ø´Ø¯Ù‡",
        'days': "Ø±ÙˆØ²"
    },
    'settings': {
        'menu': "âš™ï¸ **ØªÙ†Ø¸ÛŒÙ…Ø§Øª**\nÛŒÚ© Ú¯Ø²ÛŒÙ†Ù‡ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯:",
        'change_language': "ðŸŒ ØªØºÛŒÛŒØ± Ø²Ø¨Ø§Ù†",
        'back_to_main': "â†©ï¸ Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ"
    },
    'invitation': {
        'code_generated': "ï¿½ï¿½ï¸ Ú©Ø¯ Ø¯Ø¹ÙˆØª Ø´Ù…Ø§: `{}`\nØ§ÛŒÙ† Ú©Ø¯ Ø±Ø§ Ø¨Ø§ Ø´Ø±ÛŒÚ© Ø®ÙˆØ¯ Ø¨Ù‡ Ø§Ø´ØªØ±Ø§Ú© Ø¨Ú¯Ø°Ø§Ø±ÛŒØ¯.",
        'enter_code': "Ù„Ø·ÙØ§Ù‹ Ú©Ø¯ Ø¯Ø¹ÙˆØªÛŒ Ú©Ù‡ Ø¯Ø±ÛŒØ§ÙØª Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:",
        'accepted': "âœ… Ø¯Ø¹ÙˆØª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ù¾Ø°ÛŒØ±ÙØªÙ‡ Ø´Ø¯!",
        'generation_error': "âŒ Ø®Ø·Ø§ Ø¯Ø± ØªÙˆÙ„ÛŒØ¯ Ú©Ø¯ Ø¯Ø¹ÙˆØª. Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.",
        'acceptance_error': "âŒ Ø®Ø·Ø§ Ø¯Ø± Ù¾Ø°ÛŒØ±Ø´ Ø¯Ø¹ÙˆØª. Ù„Ø·ÙØ§Ù‹ Ú©Ø¯ Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ø±Ø¯Ù‡ Ùˆ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.",
        'invalid_code': "âŒ Ú©Ø¯ Ø¯Ø¹ÙˆØª Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª. Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯."
    }
}

# Predefined options in both languages
SYMPTOM_OPTIONS = {
    'en': [
        ['Cramps', 'Headache', 'Fatigue'],
        ['Bloating', 'Mood Swings', 'Acne'],
        ['Back Pain', 'Breast Tenderness'],
        ['Write Custom Symptoms', 'Done']
    ],
    'fa': [
        ['Ú¯Ø±ÙØªÚ¯ÛŒ', 'Ø³Ø±Ø¯Ø±Ø¯', 'Ø®Ø³ØªÚ¯ÛŒ'],
        ['Ù†ÙØ®', 'ØªØºÛŒÛŒØ±Ø§Øª Ø®Ù„Ù‚ÛŒ', 'Ø¬ÙˆØ´'],
        ['Ú©Ù…Ø± Ø¯Ø±Ø¯', 'Ø­Ø³Ø§Ø³ÛŒØª Ø³ÛŒÙ†Ù‡'],
        ['Ù†ÙˆØ´ØªÙ† Ø¹Ù„Ø§Ø¦Ù… Ø³ÙØ§Ø±Ø´ÛŒ', 'Ù¾Ø§ÛŒØ§Ù†']
    ]
}

MEDICATION_OPTIONS = {
    'en': [
        ['Ibuprofen', 'Acetaminophen'],
        ['Birth Control Pills', 'Pain Relievers'],
        ['Write Custom Medication', 'Done']
    ],
    'fa': [
        ['Ø§ÛŒØ¨ÙˆÙ¾Ø±ÙˆÙÙ†', 'Ø§Ø³ØªØ§Ù…ÛŒÙ†ÙˆÙÙ†'],
        ['Ù‚Ø±Øµâ€ŒÙ‡Ø§ÛŒ Ø¶Ø¯ Ø¨Ø§Ø±Ø¯Ø§Ø±ÛŒ', 'Ù…Ø³Ú©Ù†'],
        ['Ù†ÙˆØ´ØªÙ† Ø¯Ø§Ø±ÙˆÛŒ Ø³ÙØ§Ø±Ø´ÛŒ', 'Ù¾Ø§ÛŒØ§Ù†']
    ]
}

def get_message(lang: str, category: str, key: str, *args) -> str:
    """
    Get a message in the specified language.
    Args can be used for string formatting.
    """
    messages = EN if lang == 'en' else FA
    try:
        message = messages[category][key]
        if args:
            return message.format(*args)
        return message
    except KeyError:
        return f"Missing translation: {category}.{key}" 