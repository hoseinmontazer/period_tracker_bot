# English messages
EN = {
    'welcome': {
        'initial': "Welcome! Please select your language:\n\n!به ربات خوش آمدید! لطفا زبان خود را انتخاب کنید",
        'bot': "Welcome to Period Tracker Bot! Please choose an option:"
    },
    'menu': {
        'main': "📋 **Main Menu**\nChoose an option:",
        'track_period': "Track Period",
        'view_history': "View History",
        'cycle_analysis': "Cycle Analysis",
        'add_new_cycle': "Add New Cycle",
        'logout': "Logout",
        'language_changed': "Language changed to English",
        'invitation_partner': 'Generate Partner Invitation',
        'accept_invitation': 'Accept Invitation Code'
    },
    'auth': {
        'login_required': "⚠️ You need to log in first. Use /start.",
        'enter_username': "Please enter your username:",
        'enter_password': "Enter your password:",
        'enter_email': "Enter your email address (e.g., example@gmail.com):",
        'invalid_email': "Please enter a valid email address (e.g., example@gmail.com):",
        'reg_success': "Registration successful!",
        'login_failed': "❌ Login failed. Please try again.",
        'logged_out': "You have been logged out. Use /start to log in again.",
        'not_logged_in': "You are not logged in.",
        'register': "Register",
        'login': "Login"
    },
    'cycle': {
        'select_date': "Please select the start date:",
        'selected_date': "Selected date: {}",
        'select_symptoms': "Select your symptoms (you can select multiple):",
        'select_medications': "Select your medications (you can select multiple):",
        'custom_symptoms': "Please type your symptoms and press 'Done' when finished:",
        'custom_medication': "Please type your medication and press 'Done' when finished:",
        'added_item': "Added: {}\nSelected {}: {}\n\nSelect more or press 'Done'",
        'save_success': "✅ Cycle data has been saved successfully!",
        'save_failed': "❌ Failed to save cycle data: {}"
    },
    'buttons': {
        'done': "Done",
        'cancel': "Cancel",
        'write_custom_symptoms': "Write Custom Symptoms",
        'write_custom_medication': "Write Custom Medication"
    },
    'errors': {
        'token_expired': "Token has expired. Please try again.",
        'no_history': "ℹ️ You have no recorded period history.",
        'fetch_failed': "❌ Failed to retrieve history. Please try again later.",
        'unknown_duration': "?",
        'operation_cancelled': "Operation cancelled."
    },
    'period_history': {
        'title': "📅 **Your Period History**:",
        'cycle': "✨ *Cycle {}* ✨",
        'predicted': "🔮 Predicted",
        'duration': "⏳ Duration",
        'symptoms_title': "💫 *Symptoms*",
        'medicine_title': "💊 *Medicine*",
        'none_noted': "None noted",
        'none_taken': "None taken",
        'days': "d"  # for days abbreviation
    },
    'settings': {
        'menu': "⚙️ **Settings**\nChoose an option:",
        'change_language': "🌐 Change Language",
        'back_to_main': "↩️ Back to Main Menu"
    },
    'invitation': {
        'code_generated': "🎟️ Your invitation code is: `{}`\nShare this code with your partner.",
        'enter_code': "Please enter the invitation code you received:",
        'accepted': "✅ Invitation accepted successfully!",
        'generation_error': "❌ Error generating invitation code. Please try again.",
        'acceptance_error': "❌ Error accepting invitation. Please check the code and try again.",
        'invalid_code': "❌ Invalid invitation code. Please try again."
    }
}

# Persian messages
FA = {
    'welcome': {
        'initial': "Welcome! Please select your language:\n\n!به ربات خوش آمدید! لطفا زبان خود را انتخاب کنید",
        'bot': "به ربات ردیاب دوره خوش آمدید! لطفاً یک گزینه را انتخاب کنید:"
    },
    'menu': {
        'main': "📋 **منوی اصلی**\nیک گزینه را انتخاب کنید:",
        'track_period': "ثبت دوره",
        'view_history': "مشاهده تاریخچه",
        'cycle_analysis': "تحلیل دوره",
        'add_new_cycle': "افزودن دوره جدید",
        'logout': "خروج",
        'language_changed': "زبان به فارسی تغییر کرد",
        'invitation_partner': 'دعوت از شریک',
        'accept_invitation': 'پذیرش کد دعوت'
    },
    'auth': {
        'login_required': "⚠️ ابتدا باید وارد شوید. از /start استفاده کنید.",
        'enter_username': "لطفاً نام کاربری خود را وارد کنید:",
        'enter_password': "رمز عبور خود را وارد کنید:",
        'enter_email': "آدرس ایمیل خود را وارد کنید (مثال: example@gmail.com):",
        'invalid_email': "لطفاً یک آدرس ایمیل معتبر وارد کنید (مثال: example@gmail.com):",
        'reg_success': "ثبت نام با موفقیت انجام شد!",
        'login_failed': "❌ ورود ناموفق بود. لطفا دوباره تلاش کنید.",
        'logged_out': "شما از سیستم خارج شدید. برای ورود مجدد از /start استفاده کنید.",
        'not_logged_in': "شما وارد نشده‌اید.",
        'register': "ثبت نام",
        'login': "ورود"
    },
    'cycle': {
        'select_date': "لطفاً تاریخ شروع را انتخاب کنید:",
        'selected_date': "تاریخ انتخاب شده: {}",
        'select_symptoms': "علائم خود را انتخاب کنید (می‌توانید چند مورد را انتخاب کنید):",
        'select_medications': "داروهای خود را انتخاب کنید (می‌توانید چند مورد را انتخاب کنید):",
        'custom_symptoms': "لطفاً علائم خود را تایپ کنید و پس از اتمام 'پایان' را فشار دهید:",
        'custom_medication': "لطفاً داروی خود را تایپ کنید و پس از اتمام 'پایان' را فشار دهید:",
        'added_item': "اضافه شد: {}\nموارد انتخاب شده {}: {}\n\nموارد بیشتری انتخاب کنید یا 'پایان' را فشار دهید",
        'save_success': "✅ اطلاعات دوره با موفقیت ذخیره شد!",
        'save_failed': "❌ ذخیره اطلاعات دوره ناموفق بود: {}"
    },
    'buttons': {
        'done': "پایان",
        'cancel': "لغو",
        'write_custom_symptoms': "نوشتن علائم سفارشی",
        'write_custom_medication': "نوشتن داروی سفارشی"
    },
    'errors': {
        'token_expired': "توکن منقضی شده است. لطفا دوباره تلاش کنید.",
        'no_history': "ℹ️ شما هیچ سابقه دوره‌ای ثبت شده‌ای ندارید.",
        'fetch_failed': "❌ دریافت تاریخچه ناموفق بود. لطفاً بعداً دوباره تلاش کنید.",
        'unknown_duration': "؟",
        'operation_cancelled': "عملیات لغو شد."
    },
    'period_history': {
        'title': "📅 **تاریخچه دوره شما**:",
        'cycle': "✨ *دوره {}* ✨",
        'predicted': "🔮 پیش‌بینی شده",
        'duration': "⏳ مدت",
        'symptoms_title': "💫 *علائم*",
        'medicine_title': "💊 *دارو*",
        'none_noted': "هیچ علامتی ثبت نشده",
        'none_taken': "هیچ دارویی مصرف نشده",
        'days': "روز"
    },
    'settings': {
        'menu': "⚙️ **تنظیمات**\nیک گزینه را انتخاب کنید:",
        'change_language': "🌐 تغییر زبان",
        'back_to_main': "↩️ بازگشت به منوی اصلی"
    },
    'invitation': {
        'code_generated': "��️ کد دعوت شما: `{}`\nاین کد را با شریک خود به اشتراک بگذارید.",
        'enter_code': "لطفاً کد دعوتی که دریافت کرده‌اید را وارد کنید:",
        'accepted': "✅ دعوت با موفقیت پذیرفته شد!",
        'generation_error': "❌ خطا در تولید کد دعوت. لطفاً دوباره تلاش کنید.",
        'acceptance_error': "❌ خطا در پذیرش دعوت. لطفاً کد را بررسی کرده و دوباره تلاش کنید.",
        'invalid_code': "❌ کد دعوت نامعتبر است. لطفاً دوباره تلاش کنید."
    }
}

# Predefined options in both languages
SYMPTOM_OPTIONS = {
    'en': [
        ['Cramps', 'Headache', 'Fatigue'],
        ['Bloating', 'Mood Swings', 'Acne'],
        ['Back Pain', 'Breast Tenderness'],
        ['Write Custom Symptoms', 'Done']
    ],
    'fa': [
        ['گرفتگی', 'سردرد', 'خستگی'],
        ['نفخ', 'تغییرات خلقی', 'جوش'],
        ['کمر درد', 'حساسیت سینه'],
        ['نوشتن علائم سفارشی', 'پایان']
    ]
}

MEDICATION_OPTIONS = {
    'en': [
        ['Ibuprofen', 'Acetaminophen'],
        ['Birth Control Pills', 'Pain Relievers'],
        ['Write Custom Medication', 'Done']
    ],
    'fa': [
        ['ایبوپروفن', 'استامینوفن'],
        ['قرص‌های ضد بارداری', 'مسکن'],
        ['نوشتن داروی سفارشی', 'پایان']
    ]
}

def get_message(lang: str, category: str, key: str, *args) -> str:
    """
    Get a message in the specified language.
    Args can be used for string formatting.
    """
    messages = EN if lang == 'en' else FA
    try:
        message = messages[category][key]
        if args:
            return message.format(*args)
        return message
    except KeyError:
        return f"Missing translation: {category}.{key}" 